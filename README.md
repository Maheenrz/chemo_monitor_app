# Chemo Monitor App

A comprehensive Flutter-based mobile health monitoring application designed for chemotherapy patients and their healthcare providers. The app leverages machine learning to assess patient health risks and provides real-time communication between patients and doctors.

## Table of Contents

- [Features](#features)
- [Technology Stack](#technology-stack)
- [Architecture](#architecture)
- [Installation](#installation)
- [Configuration](#configuration)
- [Usage](#usage)
- [ML Model](#ml-model)
- [Firebase Setup](#firebase-setup)
- [API Integration](#api-integration)
- [Contributing](#contributing)
- [License](#license)

## Features

### For Patients
- **Health Vitals Monitoring**: Input and track vital signs (temperature, blood pressure, heart rate, SpO2)
- **AI-Powered Risk Assessment**: Real-time risk classification (Low, Moderate, High) using TensorFlow Lite
- **AI Chatbot Support**: Get immediate assistance through Mistral API-powered chatbot when doctors are unavailable
- **Health History**: Comprehensive tracking of medical journey with trend analysis
- **Secure Messaging**: Share text and images with assigned doctor
- **Doctor Assignment**: Easy connection with healthcare provider via unique doctor codes
- **Real-time Notifications**: Receive alerts and updates from healthcare team

### For Doctors
- **Patient Dashboard**: Manage multiple patients from a centralized interface
- **Risk Alerts**: Receive real-time notifications when patients report concerning vitals
- **Analytics Screen**: View patient trends and historical data with interactive charts
- **Secure Communication**: Direct messaging with patients including image support
- **Doctor Directory**: Generate unique codes for patient assignment (Used by patients for registeration)
- **Patient Reports**: Access comprehensive health assessments generated by ML model

## Technology Stack

| Component | Technology |
|-----------|------------|
| **Framework** | Flutter (Dart) |
| **Machine Learning** | TensorFlow Lite |
| **AI Integration** | Mistral API |
| **Backend** | Firebase (Authentication, Firestore, Cloud Storage) |
| **Storage** | Cloudinary (Images) |
| **State Management** | Provider / StreamBuilder |
| **Charts** | FL Chart |

## Architecture

### Application Flow

```
User Authentication → Role Selection → Dashboard Access
                                            ↓
                                    Vitals Input
                                            ↓
                                ML Risk Assessment (TensorFlow Lite)
                                            ↓
                                    Report Generation
                                            ↓
                        ┌───────────────────┴───────────────────┐
                        ↓                                       ↓
                AI Chatbot Support                    Doctor Notification
                        ↓                                       ↓
                        └───────────────────┬───────────────────┘
                                            ↓
                            Ongoing Communication & Monitoring
```

### Key Components

1. **Authentication Layer**: Firebase Authentication with role-based access control
2. **Data Layer**: Firestore for real-time data synchronization
3. **ML Layer**: TensorFlow Lite model for risk prediction
4. **Communication Layer**: Real-time messaging with image support
5. **AI Layer**: Mistral API integration for intelligent patient support

## Installation

### Prerequisites

- Flutter SDK (>=3.0.0)
- Dart SDK (>=3.0.0)
- Android Studio / Xcode
- Firebase CLI
- Git

### Steps

1. **Clone the repository**
```bash
git clone https://github.com/Maheenrz/chemo_monitor_app.git
cd chemo_monitor_app
```

2. **Install dependencies**
```bash
flutter pub get
```

3. **Set up Firebase**
```bash
# Install FlutterFire CLI
dart pub global activate flutterfire_cli

# Configure Firebase for your project
flutterfire configure
```

4. **Create environment file**
```bash
# Create .env file in project root
touch .env
```

Add the following to `.env`:
```
MISTRAL_API_KEY=your_mistral_api_key_here
CLOUDINARY_CLOUD_NAME=your_cloudinary_cloud_name
CLOUDINARY_API_KEY=your_cloudinary_api_key
CLOUDINARY_API_SECRET=your_cloudinary_api_secret
```

5. **Add ML Model**
- Place `model.tflite` file in `assets/models/` directory
- It's already referenced in `pubspec.yaml`

6. **Run the app**
```bash
flutter run
```

## Configuration

### Firebase Configuration

1. Create a Firebase project at [Firebase Console](https://console.firebase.google.com)
2. Enable the following services:
   - Authentication (Email/Password)
   - Cloud Firestore
   - Cloud Storage
3. Add Android/iOS apps to your Firebase project
4. Download and place configuration files:
   - `google-services.json` (Android) → `android/app/`
   - `GoogleService-Info.plist` (iOS) → `ios/Runner/`

## Usage

### Patient Workflow

1. **Registration**
   - Sign up with email and password
   - Obtain doctor's unique code from Doctor Directory
   - Enter doctor code during registration

2. **Daily Monitoring**
   - Navigate to Vitals Screen
   - Input health parameters:
     - Temperature (°C)
     - Blood Pressure (Systolic/Diastolic)
     - Heart Rate (BPM)
     - SpO2 (%)
   - Submit for ML analysis

3. **View Results**
   - Receive risk classification (Low/Moderate/High)
   - Review comprehensive report
   - Chat with AI bot for guidance

4. **Communication**
   - Message assigned doctor
   - Share images
   - View health history

### Doctor Workflow

1. **Registration**
   - Sign up as doctor
   - Receive unique doctor code
   - Share code with patients

2. **Patient Management**
   - View patient list on dashboard
   - Monitor risk alerts
   - Review patient reports with charts

3. **Communication**
   - Respond to patient messages
   - Share medical advice and images
   - Track patient progress over time

## ML Model

### Model Details

- **Framework**: TensorFlow Lite
- **Input**: Patient vital signs (normalized)
- **Output**: Risk classification (Low: 0, Moderate: 1, High: 2)
- **Model File**: `assets/models/model.tflite`

### Input Features

- **Temperature**: °Celsius
- **Blood Pressure**: Systolic/Diastolic (mmHg)
- **Heart Rate**: Beats per minute (BPM)
- **SpO2**: Oxygen Saturation (%)

### Integration

```dart
final healthService = HealthDataService();
await healthService.initializeMLModel();

final prediction = await healthService.predictRisk({
  'temperature': 37.5,
  'bloodPressureSys': 120,
  'bloodPressureDia': 80,
  'heartRate': 75,
  'spo2': 98,
});
```

## Firebase Setup

### Required Collections

1. **users**
   - `userId` (document ID)
   - `email`, `name`, `role`, `assignedDoctorId`
   - `profileImageUrl`, `createdAt`, `lastLogin`

2. **health_records**
   - `recordId` (document ID)
   - `patientId`, `doctorId`, `vitals`, `riskLevel`
   - `timestamp`, `mlPrediction`

3. **messages**
   - `messageId` (document ID)
   - `senderId`, `receiverId`, `content`, `type`
   - `timestamp`, `imageUrl`

4. **doctors**
   - `doctorId` (document ID)
   - `doctorCode`, `specialty`, `patients[]`

## API Integration

### Mistral API (AI Chatbot)

```dart
// Environment variable in .env
MISTRAL_API_KEY=your_mistral_api_key

// Usage in chat_service.dart
final response = await MistralAPI.sendMessage(
  message: userMessage,
  context: patientHealthData,
);
```

Get your API key from: [Mistral AI Platform](https://console.mistral.ai/)

### Cloudinary (Image Storage)

```dart
// Environment variables in .env
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

// Usage in cloudinary_service.dart
final imageUrl = await CloudinaryService.uploadImage(imageFile);
```

Configure your Cloudinary account at: [Cloudinary Console](https://cloudinary.com/console)

## Dependencies

Key packages used in this project:

- **firebase_core**: ^2.24.2 - Firebase initialization
- **firebase_auth**: ^4.16.0 - User authentication
- **cloud_firestore**: ^4.15.1 - NoSQL database
- **tflite_flutter**: ^0.11.0 - ML model integration
- **cloudinary_public**: ^0.21.0 - Image uploads
- **fl_chart**: ^0.66.2 - Interactive charts
- **image_picker**: ^1.0.7 - Camera/gallery access
- **flutter_markdown**: ^0.6.18 - Chatbot message rendering
- **flutter_dotenv**: ^5.1.0 - Environment configuration

For complete list, see `pubspec.yaml`

## Contributing

We welcome contributions! Please follow these steps:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

### Code Style

- Follow Dart/Flutter style guidelines
- Use meaningful variable names
- Add comments for complex logic
- Write unit tests for services

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Contact

**Developer**: Maheen Raza

**Project Link**: [https://github.com/Maheenrz/chemo_monitor_app](https://github.com/Maheenrz/chemo_monitor_app)

## Acknowledgments

- TensorFlow Lite for ML integration
- Mistral AI for chatbot intelligence
- Firebase for backend infrastructure
- Cloudinary for image management
- Flutter community for excellent packages
- FL Chart for beautiful data visualizations

---

**Note**: This application is designed for monitoring purposes and should not replace professional medical advice. Always consult with healthcare providers for medical decisions.